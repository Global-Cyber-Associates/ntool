const a39_0xacdb48=a39_0x3370;function a39_0x3370(_0x36a315,_0x24cd16){const _0x5dab98=a39_0x5dab();return a39_0x3370=function(_0x3370a8,_0x170b93){_0x3370a8=_0x3370a8-0xf6;let _0x2d5b0d=_0x5dab98[_0x3370a8];return _0x2d5b0d;},a39_0x3370(_0x36a315,_0x24cd16);}(function(_0x1bd748,_0x34ffe9){const _0x198764=a39_0x3370,_0x333c86=_0x1bd748();while(!![]){try{const _0x1562f9=-parseInt(_0x198764(0xfb))/0x1+-parseInt(_0x198764(0x10e))/0x2+-parseInt(_0x198764(0x104))/0x3*(-parseInt(_0x198764(0x109))/0x4)+parseInt(_0x198764(0xfc))/0x5+parseInt(_0x198764(0x105))/0x6+parseInt(_0x198764(0xf6))/0x7*(parseInt(_0x198764(0x110))/0x8)+-parseInt(_0x198764(0x118))/0x9*(parseInt(_0x198764(0x102))/0xa);if(_0x1562f9===_0x34ffe9)break;else _0x333c86['push'](_0x333c86['shift']());}catch(_0xeb4af9){_0x333c86['push'](_0x333c86['shift']());}}}(a39_0x5dab,0x75f24));import a39_0xc2b519 from'mongoose';import a39_0x3de879 from'fs';import a39_0x32281b from'path';import{fileURLToPath}from'url';import a39_0x911ac from'../models/VisualizerScanner.js';import a39_0xc48038 from'../models/SystemInfo.js';import a39_0x122c9d from'../models/VisualizerData.js';function a39_0x5dab(){const _0x43da26=['1779944TxEnno','data','sort','ips','url','parse','has','agent_id','4292829Fzkgmw','vendor','find','set','trim',']\x20❌\x20Visualizer\x20update\x20failed:','length','connect','toLocaleTimeString','✅\x20MongoDB\x20connected\x20for\x20visualizer\x20update','\x20active\x20devices\x20stored','7wZUWNe','⚠️\x20No\x20scan\x20results\x20found.','log','isAlive',']\x20✅\x20Visualizer\x20updated\x20—\x20','725595atVyLO','3122385AntLfP','map','Unknown','⚠️\x20No\x20active\x20devices\x20detected\x20—\x20nothing\x20updated.','ping_only','message','10mbxJdb','agentId','208605NnuhcE','2122074PaLRtK','mac','deleteMany','error','40oDGBGI','status','unknown','filter','mongo_uri','420630EIjuKk','insertMany'];a39_0x5dab=function(){return _0x43da26;};return a39_0x5dab();}const __filename=fileURLToPath(import.meta[a39_0xacdb48(0x114)]),__dirname=a39_0x32281b['dirname'](__filename),configPath=a39_0x32281b['resolve'](__dirname,'../config.json'),config=JSON[a39_0xacdb48(0x115)](a39_0x3de879['readFileSync'](configPath,'utf-8')),MONGO_URI=config[a39_0xacdb48(0x10d)];let connected=![];async function connectDB(){const _0x570861=a39_0xacdb48;!connected&&(await a39_0xc2b519[_0x570861(0x11f)](MONGO_URI,{'useNewUrlParser':!![],'useUnifiedTopology':!![]}),connected=!![],console['log'](_0x570861(0x121)));}export async function runVisualizerUpdate(){const _0x5f54ba=a39_0xacdb48;try{await connectDB();const _0x91f739=await a39_0x911ac[_0x5f54ba(0x11a)]({})[_0x5f54ba(0x112)]({'createdAt':-0x1});if(!_0x91f739['length']){console[_0x5f54ba(0xf8)](_0x5f54ba(0xf7));return;}const _0x412d5e=await a39_0xc48038[_0x5f54ba(0x11a)](),_0x5a978e=new Map(),_0x3c0557=new Map(),_0x57a8ab=new Set();_0x412d5e['forEach'](_0x36e041=>{const _0x7af5c5=_0x5f54ba,_0x37497a=_0x36e041[_0x7af5c5(0x111)]?.['wlan_info']||_0x36e041['wlan_ip']||[],_0x5d9caa=_0x36e041[_0x7af5c5(0x111)]?.['hostname']||_0x36e041['hostname']||_0x7af5c5(0xfe),_0x19e01e=_0x36e041?.[_0x7af5c5(0x117)]||_0x36e041[_0x7af5c5(0x103)]||'unknown';_0x37497a['forEach'](_0x46c58e=>{const _0x329b2b=_0x7af5c5,_0x3fbfb5=(_0x46c58e['address']||'')[_0x329b2b(0x11c)]();_0x3fbfb5&&(_0x57a8ab['add'](_0x3fbfb5),_0x5a978e[_0x329b2b(0x11b)](_0x3fbfb5,_0x5d9caa),_0x3c0557[_0x329b2b(0x11b)](_0x3fbfb5,_0x19e01e));});});const _0x3b9c4b=_0x91f739[_0x5f54ba(0x10c)](_0x3f0881=>_0x3f0881[_0x5f54ba(0xf9)]===!![]||_0x3f0881[_0x5f54ba(0x100)]===!![]||_0x3f0881[_0x5f54ba(0x10a)]==='alive'||_0x3f0881['pingSuccess']===!![]);if(!_0x3b9c4b[_0x5f54ba(0x11e)]){console['log'](_0x5f54ba(0xff));return;}const _0x5c99ed=_0x3b9c4b[_0x5f54ba(0xfd)](_0x28915b=>{const _0xb76462=_0x5f54ba,_0x45bd29=(_0x28915b[_0xb76462(0x113)]?.[0x0]||'N/A')[_0xb76462(0x11c)](),_0x14e552=_0x57a8ab[_0xb76462(0x116)](_0x45bd29),_0x4f317e=_0x14e552?_0x5a978e['get'](_0x45bd29)||_0xb76462(0xfe):_0xb76462(0xfe),_0x228b2d=_0x14e552?_0x3c0557['get'](_0x45bd29)||_0xb76462(0x10b):_0xb76462(0x10b);return{'agentId':_0x228b2d,'ip':_0x45bd29,'mac':_0x28915b[_0xb76462(0x106)]||_0xb76462(0xfe),'vendor':_0x28915b[_0xb76462(0x119)]||_0xb76462(0xfe),'hostname':_0x4f317e,'noAgent':!_0x14e552,'createdAt':new Date()};});await a39_0x122c9d[_0x5f54ba(0x107)]({}),await a39_0x122c9d[_0x5f54ba(0x10f)](_0x5c99ed),console[_0x5f54ba(0xf8)]('['+new Date()[_0x5f54ba(0x120)]()+_0x5f54ba(0xfa)+_0x5c99ed[_0x5f54ba(0x11e)]+_0x5f54ba(0x122));}catch(_0x2720a8){console[_0x5f54ba(0x108)]('['+new Date()[_0x5f54ba(0x120)]()+_0x5f54ba(0x11d),_0x2720a8[_0x5f54ba(0x101)]);}}