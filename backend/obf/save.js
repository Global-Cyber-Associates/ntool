function a33_0x4500(){const _0x362cc8=['8VwGYOj','12UJpaSv','1556505ZRQaVD',']\x20for\x20agent\x20','üíæ\x20Agent\x20[','4208696buSVAY','error','‚ÑπÔ∏è\x20USB\x20data\x20is\x20handled\x20separately.\x20Skipping\x20save\x20here.','1120227SiKkMi','‚úÖ\x20[','‚ùå\x20Failed\x20to\x20save\x20agent\x20data:','‚ö†Ô∏è\x20Unknown\x20data\x20type:\x20','agentId','timestamp','system_info','2182182gRcQyy','‚ùå\x20Failed\x20to\x20upsert\x20Agent\x20[','55016ywOVJO','data','log','findOneAndUpdate','usb_devices','installed_apps','‚ùå\x20Failed\x20to\x20save\x20[','‚ùå\x20Invalid\x20payload:\x20missing\x20type,\x20data,\x20or\x20agentId','1082405IQkQKw','task_info','30HuuiPg','toISOString','socket_id','warn','unknown','577577HFTevM'];a33_0x4500=function(){return _0x362cc8;};return a33_0x4500();}(function(_0x373448,_0x8955af){const _0x7345b6=a33_0x5d7e,_0x1e9421=_0x373448();while(!![]){try{const _0x3cfc56=parseInt(_0x7345b6(0xbb))/0x1*(-parseInt(_0x7345b6(0xcb))/0x2)+parseInt(_0x7345b6(0xd3))/0x3+-parseInt(_0x7345b6(0xcc))/0x4*(-parseInt(_0x7345b6(0xc3))/0x5)+-parseInt(_0x7345b6(0xda))/0x6+-parseInt(_0x7345b6(0xca))/0x7+-parseInt(_0x7345b6(0xd0))/0x8+parseInt(_0x7345b6(0xcd))/0x9*(parseInt(_0x7345b6(0xc5))/0xa);if(_0x3cfc56===_0x8955af)break;else _0x1e9421['push'](_0x1e9421['shift']());}catch(_0x23cd8d){_0x1e9421['push'](_0x1e9421['shift']());}}}(a33_0x4500,0x55490));import a33_0x4bb66e from'./models/Agent.js';import a33_0x33e073 from'./models/SystemInfo.js';import a33_0x4bb03f from'./models/InstalledApps.js';function a33_0x5d7e(_0x4baa34,_0xe852a3){const _0x450034=a33_0x4500();return a33_0x5d7e=function(_0x5d7e9d,_0xa61087){_0x5d7e9d=_0x5d7e9d-0xbb;let _0x485804=_0x450034[_0x5d7e9d];return _0x485804;},a33_0x5d7e(_0x4baa34,_0xe852a3);}import a33_0x5e04a4 from'./models/PortScan.js';import a33_0x37c13a from'./models/TaskInfo.js';export async function saveAgentData(_0x4cc65d){const _0x1a541c=a33_0x5d7e;try{if(!_0x4cc65d||!_0x4cc65d['type']||!_0x4cc65d[_0x1a541c(0xbc)]||!_0x4cc65d[_0x1a541c(0xd7)]){console[_0x1a541c(0xd1)](_0x1a541c(0xc2));return;}const {type:_0x2c6ddc,agentId:_0x1f9427,data:_0x4dcb7c}=_0x4cc65d,_0x5ea8db=_0x4cc65d[_0x1a541c(0xd8)]||new Date()[_0x1a541c(0xc6)]();try{await a33_0x4bb66e['findOneAndUpdate']({'agentId':_0x1f9427},{'$set':{'agentId':_0x1f9427,'socketId':_0x4cc65d[_0x1a541c(0xc7)]||null,'ip':_0x4cc65d['ip']||_0x1a541c(0xc9),'lastSeen':new Date()}},{'upsert':!![],'new':!![]}),console[_0x1a541c(0xbd)](_0x1a541c(0xcf)+_0x1f9427+']\x20saved/updated');}catch(_0x3a03aa){console[_0x1a541c(0xd1)](_0x1a541c(0xdb)+_0x1f9427+']:',_0x3a03aa);return;}if(_0x2c6ddc===_0x1a541c(0xbf)){console[_0x1a541c(0xbd)](_0x1a541c(0xd2));return;}let _0xf8622b;switch(_0x2c6ddc){case _0x1a541c(0xd9):_0xf8622b=a33_0x33e073;break;case _0x1a541c(0xc0):_0xf8622b=a33_0x4bb03f;break;case'port_scan':_0xf8622b=a33_0x5e04a4;break;case _0x1a541c(0xc4):_0xf8622b=a33_0x37c13a;break;default:console[_0x1a541c(0xc8)](_0x1a541c(0xd6)+_0x2c6ddc+'.\x20Ignoring.');return;}const _0x4bb7f9={'agentId':_0x1f9427,'timestamp':_0x5ea8db,'type':_0x2c6ddc,'data':_0x4dcb7c};try{await _0xf8622b[_0x1a541c(0xbe)]({'agentId':_0x1f9427},{'$set':_0x4bb7f9},{'upsert':!![],'new':!![]}),console[_0x1a541c(0xbd)](_0x1a541c(0xd4)+_0x2c6ddc+']\x20saved\x20for\x20agent\x20'+_0x1f9427);}catch(_0x5d37c7){console['error'](_0x1a541c(0xc1)+_0x2c6ddc+_0x1a541c(0xce)+_0x1f9427+':',_0x5d37c7);}}catch(_0x69e8d3){console[_0x1a541c(0xd1)](_0x1a541c(0xd5),_0x69e8d3);}}