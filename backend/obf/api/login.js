const a5_0x18c6b2=a5_0xf325;(function(_0x1b6e03,_0x3f171e){const _0x5b058d=a5_0xf325,_0x5603a8=_0x1b6e03();while(!![]){try{const _0x4955fc=-parseInt(_0x5b058d(0x197))/0x1*(parseInt(_0x5b058d(0x188))/0x2)+parseInt(_0x5b058d(0x198))/0x3*(parseInt(_0x5b058d(0x1a9))/0x4)+parseInt(_0x5b058d(0x195))/0x5*(-parseInt(_0x5b058d(0x1a1))/0x6)+parseInt(_0x5b058d(0x1a3))/0x7*(parseInt(_0x5b058d(0x193))/0x8)+parseInt(_0x5b058d(0x1a6))/0x9*(parseInt(_0x5b058d(0x18d))/0xa)+parseInt(_0x5b058d(0x1a2))/0xb+parseInt(_0x5b058d(0x191))/0xc*(-parseInt(_0x5b058d(0x19c))/0xd);if(_0x4955fc===_0x3f171e)break;else _0x5603a8['push'](_0x5603a8['shift']());}catch(_0x34e6e3){_0x5603a8['push'](_0x5603a8['shift']());}}}(a5_0x5c17,0xa0839));import a5_0x35bd7b from'express';import a5_0x517767 from'bcrypt';function a5_0xf325(_0xe26be5,_0x50ff4d){const _0x5c17e8=a5_0x5c17();return a5_0xf325=function(_0xf325af,_0x4e46e0){_0xf325af=_0xf325af-0x187;let _0x4bdb51=_0x5c17e8[_0xf325af];return _0x4bdb51;},a5_0xf325(_0xe26be5,_0x50ff4d);}import a5_0xc65852 from'jsonwebtoken';import a5_0x43c937 from'dotenv';function a5_0x5c17(){const _0x10fb4f=['x-forwarded-for','9hCfWpp','Invalid\x20credentials','LOGIN_ERROR','57064dBJCxW','sign','error','2278AysFWH','Internal\x20server\x20error','message','remoteAddress','LOGIN_FAIL','12264090IFzkbY','findOne','config','socket','20954316WZUWbT','headers','2077480dRJSiF','json','2225GFQMDC','compare','170gIoJvh','126FetsGt','Wrong\x20password','post','body','13anfvbU','Invalid\x20username','password','status','env','4566JnakEb','6500802KbbByU','14AiTUcU','User\x20logged\x20in\x20successfully'];a5_0x5c17=function(){return _0x10fb4f;};return a5_0x5c17();}import a5_0x4962ad from'../models/User.js';import{addLog}from'../utils/logger.js';a5_0x43c937[a5_0x18c6b2(0x18f)]();const router=a5_0x35bd7b['Router'](),JWT_SECRET=process[a5_0x18c6b2(0x1a0)]['JWT_SECRET'];router[a5_0x18c6b2(0x19a)]('/login',async(_0xfc2263,_0x278234)=>{const _0x23756f=a5_0x18c6b2,{username:_0x517002,password:_0x6956ce}=_0xfc2263[_0x23756f(0x19b)],_0x52d3b4=_0xfc2263[_0x23756f(0x192)][_0x23756f(0x1a5)]||_0xfc2263[_0x23756f(0x190)][_0x23756f(0x18b)];try{const _0x501f72=await a5_0x4962ad[_0x23756f(0x18e)]({'username':_0x517002});if(!_0x501f72)return await addLog(_0x23756f(0x18c),_0x23756f(0x19d),_0x517002,{'ip':_0x52d3b4}),_0x278234['status'](0x191)[_0x23756f(0x194)]({'message':_0x23756f(0x1a7)});const _0x15dd73=await a5_0x517767[_0x23756f(0x196)](_0x6956ce,_0x501f72[_0x23756f(0x19e)]);if(!_0x15dd73)return await addLog('LOGIN_FAIL',_0x23756f(0x199),_0x517002,{'ip':_0x52d3b4}),_0x278234[_0x23756f(0x19f)](0x191)[_0x23756f(0x194)]({'message':'Invalid\x20credentials'});const _0x1c7d27=a5_0xc65852[_0x23756f(0x1aa)]({'username':_0x501f72['username']},JWT_SECRET,{'expiresIn':'1h'});return await addLog('LOGIN_SUCCESS',_0x23756f(0x1a4),_0x517002,{'ip':_0x52d3b4}),_0x278234[_0x23756f(0x194)]({'success':!![],'token':_0x1c7d27});}catch(_0x53a9cb){return console[_0x23756f(0x187)]('‚ùå\x20Login\x20error:',_0x53a9cb),await addLog(_0x23756f(0x1a8),'Internal\x20server\x20error\x20during\x20login',_0x517002||'unknown',{'ip':_0x52d3b4,'error':_0x53a9cb[_0x23756f(0x18a)]}),_0x278234[_0x23756f(0x19f)](0x1f4)[_0x23756f(0x194)]({'message':_0x23756f(0x189)});}});export default router;