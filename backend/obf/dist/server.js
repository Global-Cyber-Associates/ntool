const a18_0x2e9e06=a18_0xd4ef;(function(_0x298536,_0x334efa){const _0x30d9ff=a18_0xd4ef,_0x313ade=_0x298536();while(!![]){try{const _0x5cb54c=-parseInt(_0x30d9ff(0x17e))/0x1+-parseInt(_0x30d9ff(0x1f8))/0x2*(-parseInt(_0x30d9ff(0x1d9))/0x3)+-parseInt(_0x30d9ff(0x167))/0x4*(parseInt(_0x30d9ff(0x143))/0x5)+parseInt(_0x30d9ff(0x178))/0x6+parseInt(_0x30d9ff(0x197))/0x7*(-parseInt(_0x30d9ff(0x1d6))/0x8)+-parseInt(_0x30d9ff(0x15f))/0x9*(parseInt(_0x30d9ff(0x137))/0xa)+parseInt(_0x30d9ff(0x185))/0xb;if(_0x5cb54c===_0x334efa)break;else _0x313ade['push'](_0x313ade['shift']());}catch(_0x15028b){_0x313ade['push'](_0x313ade['shift']());}}}(a18_0x11ff,0x7b8bd));var ae=Object[a18_0x2e9e06(0x1d3)],w=(_0x2d5cba,_0x8c4487)=>()=>(_0x2d5cba&&(_0x8c4487=_0x2d5cba(_0x2d5cba=0x0)),_0x8c4487),ie=(_0x1afeb7,_0x367892)=>{for(var _0x5dffb7 in _0x367892)ae(_0x1afeb7,_0x5dffb7,{'get':_0x367892[_0x5dffb7],'enumerable':!0x0});};import a18_0x43d61f from'mongoose';var de,me,le,ue,ge,d,f=w(()=>{const _0x2290d4=a18_0x2e9e06;de=new a18_0x43d61f[(_0x2290d4(0x141))]({'physical_cores':Number,'logical_cores':Number,'cpu_freq_mhz':Number}),me=new a18_0x43d61f['Schema']({'total_ram':Number,'available_ram':Number,'used_ram':Number,'ram_percent':Number}),le=new a18_0x43d61f[(_0x2290d4(0x141))]({'mountpoint':String,'fstype':String,'total':Number,'used':Number,'free':Number,'percent':Number}),ue=new a18_0x43d61f[(_0x2290d4(0x141))]({'interface_name':String,'type':String,'address':String,'netmask':String,'broadcast':String}),ge=new a18_0x43d61f['Schema']({'agentId':{'type':String,'required':!0x0,'index':!0x0,'ref':_0x2290d4(0x13d)},'timestamp':{'type':String,'required':!0x0},'type':{'type':String,'default':_0x2290d4(0x1da)},'data':{'agent_id':String,'hostname':String,'os_type':String,'os_version':String,'os_release':String,'cpu':de,'memory':me,'disk':{'type':Map,'of':le},'users':[String],'machine_id':String,'wlan_info':[ue],'ip':String}}),d=a18_0x43d61f[_0x2290d4(0x132)](_0x2290d4(0x171),ge);});import a18_0x11e517 from'mongoose';var L,ve,l,$=w(()=>{const _0x3b120d=a18_0x2e9e06;L=new a18_0x11e517[(_0x3b120d(0x141))]({'agentId':{'type':String,'required':!0x0,'index':!0x0,'ref':_0x3b120d(0x13d)},'ip':{'type':String,'required':!0x0},'mac':{'type':String,'required':!0x0},'vendor':String,'hostname':{'type':String,'default':_0x3b120d(0x1e4)},'noAgent':{'type':Boolean,'default':!0x1},'createdAt':{'type':Date,'default':Date['now']}}),L[_0x3b120d(0x193)]({'ip':0x1}),(ve=a18_0x11e517['model'](_0x3b120d(0x192),L),l=ve);});import a18_0x2fc30b from'mongoose';var X,S,j=w(()=>{const _0x318f0b=a18_0x2e9e06;X=new a18_0x2fc30b['Schema']({'agentId':{'type':String,'required':!0x0,'index':!0x0,'ref':_0x318f0b(0x13d)},'mac':{'type':String,'default':null},'ips':[{'type':String}],'vendor':{'type':String,'default':_0x318f0b(0x1e4)},'mobile':{'type':Boolean,'default':!0x1},'ping_only':{'type':Boolean,'default':!0x1},'lastSeen':{'type':Date,'default':Date[_0x318f0b(0x165)]}}),X['index']({'ips.0':0x1}),S=a18_0x2fc30b[_0x318f0b(0x132)](_0x318f0b(0x16a),X);}),ee={};ie(ee,{'runVisualizerUpdate':()=>Pe});import a18_0x5168fb from'mongoose';import a18_0x5703fa from'fs';import a18_0x54a367 from'path';import{fileURLToPath as a18_0x1ad103}from'url';async function qe(){Y||(await a18_0x5168fb['connect'](Fe,{'useNewUrlParser':!0x0,'useUnifiedTopology':!0x0}),Y=!0x0,console['log']('âœ…\x20MongoDB\x20connected\x20for\x20visualizer\x20update'));}async function Pe(){const _0x36b387=a18_0x2e9e06;try{await qe();let _0x4972b3=await S[_0x36b387(0x159)]({})[_0x36b387(0x1a3)]({'createdAt':-0x1});if(!_0x4972b3[_0x36b387(0x156)]){console[_0x36b387(0x139)](_0x36b387(0x1a4));return;}let _0xf6808c=await d[_0x36b387(0x159)](),_0x47e7a5=new Map(),_0x37121b=new Map(),_0x4b1597=new Set();_0xf6808c[_0x36b387(0x19c)](_0x229001=>{const _0x548f15=_0x36b387;let _0x5bed7c=_0x229001[_0x548f15(0x1e0)]?.[_0x548f15(0x15c)]||_0x229001[_0x548f15(0x1c6)]||[],_0x316bfd=_0x229001[_0x548f15(0x1e0)]?.[_0x548f15(0x1b7)]||_0x229001[_0x548f15(0x1b7)]||_0x548f15(0x1e4),_0x4611a3=_0x229001?.[_0x548f15(0x186)]||_0x229001[_0x548f15(0x151)]||_0x548f15(0x181);_0x5bed7c[_0x548f15(0x19c)](_0x90fc29=>{const _0x5d39fd=_0x548f15;let _0x47915d=(_0x90fc29[_0x5d39fd(0x18c)]||'')[_0x5d39fd(0x1f7)]();_0x47915d&&(_0x4b1597['add'](_0x47915d),_0x47e7a5[_0x5d39fd(0x1f1)](_0x47915d,_0x316bfd),_0x37121b[_0x5d39fd(0x1f1)](_0x47915d,_0x4611a3));});});let _0x339628=_0x4972b3[_0x36b387(0x19e)](_0x4aecaf=>_0x4aecaf[_0x36b387(0x134)]===!0x0||_0x4aecaf[_0x36b387(0x191)]===!0x0||_0x4aecaf['status']===_0x36b387(0x14e)||_0x4aecaf['pingSuccess']===!0x0);if(!_0x339628[_0x36b387(0x156)]){console[_0x36b387(0x139)](_0x36b387(0x1ac));return;}let _0x40491b=_0x339628['map'](_0x275e7c=>{const _0x1b4e42=_0x36b387;let _0x45c221=(_0x275e7c[_0x1b4e42(0x161)]?.[0x0]||_0x1b4e42(0x1b6))[_0x1b4e42(0x1f7)](),_0x21738a=_0x4b1597['has'](_0x45c221),_0x2405d2=_0x21738a&&_0x47e7a5['get'](_0x45c221)||_0x1b4e42(0x1e4);return{'agentId':_0x21738a&&_0x37121b[_0x1b4e42(0x1ad)](_0x45c221)||'unknown','ip':_0x45c221,'mac':_0x275e7c[_0x1b4e42(0x173)]||_0x1b4e42(0x1e4),'vendor':_0x275e7c['vendor']||_0x1b4e42(0x1e4),'hostname':_0x2405d2,'noAgent':!_0x21738a,'createdAt':new Date()};});await l[_0x36b387(0x1ba)]({}),await l[_0x36b387(0x19b)](_0x40491b),console[_0x36b387(0x139)]('['+new Date()[_0x36b387(0x14d)]()+']\x20âœ…\x20Visualizer\x20updated\x20â€”\x20'+_0x40491b[_0x36b387(0x156)]+_0x36b387(0x16b));}catch(_0x6c4779){console[_0x36b387(0x175)]('['+new Date()[_0x36b387(0x14d)]()+_0x36b387(0x1af),_0x6c4779[_0x36b387(0x1e8)]);}}var je,Me,Oe,Be,Fe,Y,te=w(()=>{const _0x41ed63=a18_0x2e9e06;j(),f(),$(),(je=a18_0x1ad103(import.meta[_0x41ed63(0x180)]),Me=a18_0x54a367[_0x41ed63(0x1e2)](je),Oe=a18_0x54a367[_0x41ed63(0x1ab)](Me,_0x41ed63(0x19f)),Be=JSON[_0x41ed63(0x1c9)](a18_0x5703fa['readFileSync'](Oe,'utf-8')),Fe=Be['mongo_uri'],Y=!0x1);});function a18_0x11ff(){const _0x3c93bc=['âš ï¸\x20No\x20scan\x20results\x20found.','save','body','exit','[ðŸ“¡]\x20USB\x20statuses\x20sent\x20back\x20to\x20agent:','use','âœ…\x20MongoDB\x20connected','resolve','âš ï¸\x20No\x20active\x20devices\x20detected\x20â€”\x20nothing\x20updated.','get','Blocked',']\x20âŒ\x20Visualizer\x20update\x20failed:','task_info','machine_id','âŒ\x20Failed\x20to\x20log\x20agent\x20data:','Failed\x20to\x20save\x20system\x20info','createServer','USBDevices','N/A','hostname','Internal\x20server\x20error','installed_apps','deleteMany','vendor_id','ðŸš€\x20Socket\x20server\x20running\x20on\x20port\x20','MongoDB\x20URI\x20is\x20required','ðŸ”¥\x20Python\x20error:','connected_devices',']\x20saved/updated','ðŸ“¡\x20Received\x20','âŒ\x20Failed\x20to\x20save\x20[','socket_port','timestamp','handshake','wlan_ip','ðŸš€\x20Starting\x20Python\x20scanner\x20cycle...','âš ï¸\x20Unknown\x20data\x20type:\x20','parse','Status\x20updated\x20successfully','setEncoding','\x20â†’\x20status:\x20','catch','PortScan','toString','description','connected','usb_validation','defineProperty','âŒ\x20Failed\x20to\x20write\x20received.json:','writeFileSync','8WFvKLy','Agents\x20fetched\x20successfully','product_id','33LBhQlX','system_info','âœ…\x20Connected\x20to\x20MongoDB\x20(scanner)','json','_id','pipe','status','data','âœ…\x20Visualizer\x20update\x20completed.','dirname','os_version','Unknown','startsWith','utf-8','readFileSync','message','â³\x20Waiting\x205\x20seconds\x20before\x20next\x20scan...','No\x20system\x20data\x20provided','System\x20info\x20saved','agents','ðŸ’¥\x20Failed\x20to\x20start\x20server:','âŒ\x20MongoDB\x20connection\x20failed:','cwd','[ðŸ“¦]\x20Received\x20','set','GET','\x20agents','WaitingForApproval','agent_response','âŒ\x20Failed\x20to\x20save\x20agent\x20data:','trim','142996eAIfYy','[âœ…]\x20USB\x20statuses\x20updated\x20for\x20agent:','/status','âœ…\x20Found\x20','ALL','âš \x20Invalid\x20type\x20requested:\x20','usb_devices','model','[âœ…]\x20USB\x20statuses\x20sent\x20to\x20agent:','isAlive','slice','\x20records...','80krQxad','âœ…\x20[','log','push','Invalid\x20payload\x20format','ðŸ“¤\x20Returning\x20','Agent','then','\x20entry\x20for\x20agent\x20','âŒ\x20MongoDB\x20connection\x20error:','Schema','0.0.0.0','30czOcQW','Server\x20error','mongodb+srv://','close','[ðŸ”¹]\x20Connected\x20devices\x20received:','ðŸ”¥\x20Error\x20fetching\x20[','/system','\x0aðŸŒ€\x20New\x20scan\x20cycle\x20started\x20at\x20','system','agent_data','toLocaleTimeString','alive','received.json','findOne','agentId','serial_number','mongo_uri','ðŸ”\x20Looking\x20for\x20latest\x20','\x20â†’\x20status:\x20WaitingForApproval','length','map','emit','find','endsWith','Failed\x20to\x20fetch\x20data','wlan_info','stringify','os_type','984726NdjrUJ','\x20data\x20for\x20','ips','cors_origin','\x20devices\x20to\x20DB','utf8','now','âŒ\x20Failed\x20to\x20upsert\x20Agent\x20[','398836mFjyqX','warn','post','VisualizerScanner','\x20active\x20devices\x20stored','ðŸ’¾\x20Agent\x20[','Failed\x20to\x20fetch\x20system\x20info','\x20saved\x20successfully','findOneAndUpdate','port_scan','SystemInfo','âŒ\x20Visualizer\x20update\x20failed:','mac','âŒ\x20Error\x20handling\x20agent\x20data:','error','stderr','split','5794170msRedi','Router',']\x20for\x20agent\x20','TaskInfo','/api/visualizer-data','[ðŸ†•]\x20Agent\x20document\x20created\x20for\x20agentId=','660229sCnOas','socket_id','url','unknown','indexOf','get_data','...','17560994rwVJBd','agent_id','âŒ\x20Invalid\x20payload:\x20missing\x20type,\x20data,\x20or\x20agentId',']\x20saved\x20for\x20agent\x20','listen','/api','toISOString','address','ðŸ”\x20Scanner\x20cycle\x20finished\x20with\x20code\x20','python',']\x20for\x20','ðŸ“‹\x20Fetching\x20all\x20','ping_only','VisualizerData','index','Allowed','InstalledApps','type','4961509ldiQAg','ignore','join','\x20from\x20agent\x20','insertMany','forEach','stdout','filter','../config.json','âœ…\x20MongoDB\x20URI\x20detected:','Missing\x20required\x20fields','mongodb://','sort'];a18_0x11ff=function(){return _0x3c93bc;};return a18_0x11ff();}import a18_0x558ca6 from'express';import a18_0x3a71a3 from'http';import a18_0xe4411a from'cors';import a18_0x2314e2 from'fs';import a18_0x3c3590 from'path';import{Server as a18_0x3b0423}from'socket.io';import a18_0x1f3750 from'mongoose';async function P(_0x58b702,_0x502063={}){const _0x4bc59d=a18_0x2e9e06;if(!_0x58b702)throw new Error(_0x4bc59d(0x1bd));let _0x17ae49={'useNewUrlParser':!0x0,'useUnifiedTopology':!0x0,'serverSelectionTimeoutMS':0x2710,..._0x502063};try{return await a18_0x1f3750['connect'](_0x58b702,_0x17ae49),console[_0x4bc59d(0x139)](_0x4bc59d(0x1aa)),a18_0x1f3750['connection'];}catch(_0xce3372){throw console['error'](_0x4bc59d(0x140),_0xce3372[_0x4bc59d(0x1e8)]||_0xce3372),_0xce3372;}}import a18_0x2b080a from'mongoose';var ce=new a18_0x2b080a[(a18_0x2e9e06(0x141))]({'agentId':{'type':String,'required':!0x0,'unique':!0x0},'socketId':{'type':String},'ip':{'type':String},'lastSeen':{'type':Date,'default':Date[a18_0x2e9e06(0x165)]}}),_=a18_0x2b080a[a18_0x2e9e06(0x132)](a18_0x2e9e06(0x13d),ce);function a18_0xd4ef(_0xaf6bdf,_0x305593){const _0x11ffb6=a18_0x11ff();return a18_0xd4ef=function(_0xd4ef97,_0x984afe){_0xd4ef97=_0xd4ef97-0x130;let _0x5e32bf=_0x11ffb6[_0xd4ef97];return _0x5e32bf;},a18_0xd4ef(_0xaf6bdf,_0x305593);}f();import a18_0x196c24 from'mongoose';var pe=new a18_0x196c24['Schema']({'name':String,'version':String,'publisher':String,'install_date':String,'install_location':String,'uninstall_string':String,'display_icon':String,'registry_key':String}),fe=new a18_0x196c24['Schema']({'agentId':{'type':String,'required':!0x0,'index':!0x0,'ref':a18_0x2e9e06(0x13d)},'timestamp':{'type':String,'required':!0x0},'type':{'type':String,'default':a18_0x2e9e06(0x1b9)},'data':{'apps':[pe],'count':Number}}),v=a18_0x196c24[a18_0x2e9e06(0x132)](a18_0x2e9e06(0x195),fe);import a18_0x20ac9f from'mongoose';var Se=new a18_0x20ac9f['Schema']({'agentId':{'type':String,'required':!0x0,'index':!0x0,'ref':a18_0x2e9e06(0x13d)},'timestamp':{'type':String,'required':!0x0},'type':{'type':String,'default':'port_scan'},'data':{'target':String,'open_ports':[Number],'scanned_range':String}}),b=a18_0x20ac9f[a18_0x2e9e06(0x132)](a18_0x2e9e06(0x1ce),Se);import a18_0x364259 from'mongoose';var he=new a18_0x364259[(a18_0x2e9e06(0x141))]({'pid':Number,'name':String,'title':String,'cpu_percent':Number,'memory_percent':Number}),ye=new a18_0x364259[(a18_0x2e9e06(0x141))]({'pid':Number,'name':String,'cpu_percent':Number,'memory_percent':Number}),we=new a18_0x364259[(a18_0x2e9e06(0x141))]({'agentId':{'type':String,'required':!0x0,'index':!0x0,'ref':a18_0x2e9e06(0x13d)},'timestamp':{'type':String,'required':!0x0},'type':{'type':String,'default':a18_0x2e9e06(0x1b0)},'data':{'applications':[he],'background_processes':[ye]}}),I=a18_0x364259['model'](a18_0x2e9e06(0x17b),we);async function T(_0xd34aef){const _0x592ae7=a18_0x2e9e06;try{if(!_0xd34aef||!_0xd34aef['type']||!_0xd34aef[_0x592ae7(0x1e0)]||!_0xd34aef[_0x592ae7(0x151)]){console[_0x592ae7(0x175)](_0x592ae7(0x187));return;}let {type:_0x90ae8f,agentId:_0x4fc38b,data:_0x52998d}=_0xd34aef,_0x23070e=_0xd34aef[_0x592ae7(0x1c4)]||new Date()[_0x592ae7(0x18b)]();try{await _[_0x592ae7(0x16f)]({'agentId':_0x4fc38b},{'$set':{'agentId':_0x4fc38b,'socketId':_0xd34aef[_0x592ae7(0x17f)]||null,'ip':_0xd34aef['ip']||_0x592ae7(0x181),'lastSeen':new Date()}},{'upsert':!0x0,'new':!0x0}),console['log'](_0x592ae7(0x16c)+_0x4fc38b+_0x592ae7(0x1c0));}catch(_0x4d325a){console[_0x592ae7(0x175)](_0x592ae7(0x166)+_0x4fc38b+']:',_0x4d325a);return;}if(_0x90ae8f===_0x592ae7(0x131)){console[_0x592ae7(0x139)]('â„¹ï¸\x20USB\x20data\x20is\x20handled\x20separately.\x20Skipping\x20save\x20here.');return;}let _0x5989de;switch(_0x90ae8f){case _0x592ae7(0x1da):_0x5989de=d;break;case'installed_apps':_0x5989de=v;break;case _0x592ae7(0x170):_0x5989de=b;break;case _0x592ae7(0x1b0):_0x5989de=I;break;default:console[_0x592ae7(0x168)](_0x592ae7(0x1c8)+_0x90ae8f+'.\x20Ignoring.');return;}let _0x42ce01={'agentId':_0x4fc38b,'timestamp':_0x23070e,'type':_0x90ae8f,'data':_0x52998d};try{await _0x5989de[_0x592ae7(0x16f)]({'agentId':_0x4fc38b},{'$set':_0x42ce01},{'upsert':!0x0,'new':!0x0}),console[_0x592ae7(0x139)](_0x592ae7(0x138)+_0x90ae8f+_0x592ae7(0x188)+_0x4fc38b);}catch(_0x1c05db){console[_0x592ae7(0x175)](_0x592ae7(0x1c2)+_0x90ae8f+_0x592ae7(0x17a)+_0x4fc38b+':',_0x1c05db);}}catch(_0x4e12f6){console[_0x592ae7(0x175)](_0x592ae7(0x1f6),_0x4e12f6);}}f();import a18_0x1d29b2 from'mongoose';var _e=new a18_0x1d29b2['Schema']({'agentId':{'type':String,'required':!0x0,'unique':!0x0},'data':{'connected_devices':[{'drive_letter':{'type':String,'default':''},'vendor_id':{'type':String,'default':''},'product_id':{'type':String,'default':''},'description':{'type':String,'default':''},'serial_number':{'type':String,'required':!0x0},'status':{'type':String,'enum':[a18_0x2e9e06(0x194),a18_0x2e9e06(0x1ae),'WaitingForApproval'],'default':'WaitingForApproval'},'last_seen':{'type':Date,'default':Date[a18_0x2e9e06(0x165)]}}]}},{'timestamps':!0x0}),m=a18_0x1d29b2[a18_0x2e9e06(0x132)](a18_0x2e9e06(0x1b5),_e);$();async function W({type:_0x42b877,agentId:_0x3f0309}){const _0x4b4a25=a18_0x2e9e06;try{console['log']('ðŸ“¡\x20Fetching\x20['+_0x42b877+']\x20for\x20agent:\x20'+(_0x3f0309||_0x4b4a25(0x1fc)));let _0x1d45e1;switch(_0x42b877){case _0x4b4a25(0x1da):_0x1d45e1=d;break;case _0x4b4a25(0x1b9):_0x1d45e1=v;break;case _0x4b4a25(0x131):_0x1d45e1=m;break;case _0x4b4a25(0x170):_0x1d45e1=b;break;case _0x4b4a25(0x1b0):_0x1d45e1=I;break;case'visualizer_data':_0x1d45e1=l;break;case _0x4b4a25(0x1ec):let _0x42198a=await _[_0x4b4a25(0x159)]({});return console[_0x4b4a25(0x139)](_0x4b4a25(0x1fb)+_0x42198a['length']+_0x4b4a25(0x1f3)),{'success':!0x0,'message':_0x4b4a25(0x1d7),'data':_0x42198a};default:return console[_0x4b4a25(0x168)](_0x4b4a25(0x130)+_0x42b877),{'success':!0x1,'message':'Invalid\x20data\x20type','data':[]};}let _0x3fdf68;if(_0x3f0309){console[_0x4b4a25(0x139)](_0x4b4a25(0x154)+_0x42b877+_0x4b4a25(0x13f)+_0x3f0309+_0x4b4a25(0x184));let _0x2d9e34=await _0x1d45e1[_0x4b4a25(0x150)]({'agentId':_0x3f0309})[_0x4b4a25(0x1a3)]({'timestamp':-0x1});if(!_0x2d9e34)return console[_0x4b4a25(0x168)]('âŒ\x20No\x20'+_0x42b877+'\x20data\x20found\x20for\x20'+_0x3f0309),{'success':!0x1,'message':'No\x20'+_0x42b877+'\x20data\x20found\x20for\x20agent\x20'+_0x3f0309,'data':[]};if(_0x42b877===_0x4b4a25(0x1b0)){let _0x13d6f9=await d[_0x4b4a25(0x150)]({'agentId':_0x3f0309})[_0x4b4a25(0x1a3)]({'timestamp':-0x1});_0x3fdf68=[{'agentId':_0x2d9e34[_0x4b4a25(0x151)],'device':_0x13d6f9?{'hostname':_0x13d6f9[_0x4b4a25(0x1e0)][_0x4b4a25(0x1b7)],'os_type':_0x13d6f9['data'][_0x4b4a25(0x15e)],'os_version':_0x13d6f9[_0x4b4a25(0x1e0)][_0x4b4a25(0x1e3)]}:null,'data':_0x2d9e34['data'],'timestamp':_0x2d9e34[_0x4b4a25(0x1c4)]}];}else _0x3fdf68=[_0x2d9e34];}else console[_0x4b4a25(0x139)](_0x4b4a25(0x190)+_0x42b877+_0x4b4a25(0x136)),_0x3fdf68=await _0x1d45e1[_0x4b4a25(0x159)]({});return console[_0x4b4a25(0x139)](_0x4b4a25(0x13c)+_0x42b877+_0x4b4a25(0x160)+(_0x3f0309||_0x4b4a25(0x1fc))),{'success':!0x0,'message':_0x42b877+'\x20data\x20fetched\x20successfully','data':_0x3fdf68};}catch(_0x25b488){return console['error'](_0x4b4a25(0x148)+_0x42b877+_0x4b4a25(0x18f)+_0x3f0309+':',_0x25b488),{'success':!0x1,'message':'Internal\x20server\x20error\x20while\x20fetching\x20data','error':_0x25b488[_0x4b4a25(0x1e8)],'data':[]};}}import a18_0xcf1104 from'fs';import a18_0x15b2ba from'path';async function J(_0x47fb15,_0x3f41a9,_0x53863c){const _0x2eee98=a18_0x2e9e06;if(!_0x3f41a9||_0x3f41a9['length']===0x0)return[];try{let _0x15e61e=a18_0x15b2ba[_0x2eee98(0x199)](process[_0x2eee98(0x1ef)](),_0x2eee98(0x14f));a18_0xcf1104['writeFileSync'](_0x15e61e,JSON[_0x2eee98(0x15d)]({'agentId':_0x47fb15,'timestamp':new Date(),'devices':_0x3f41a9},null,0x2),_0x2eee98(0x1e6)),console[_0x2eee98(0x139)]('[ðŸ’¾]\x20Received\x20USB\x20devices\x20logged\x20to:\x20'+_0x15e61e);}catch(_0x39083b){console[_0x2eee98(0x175)](_0x2eee98(0x1d4),_0x39083b);}let _0x52a22d=await m[_0x2eee98(0x150)]({'agentId':_0x47fb15});_0x52a22d?_0x52a22d[_0x2eee98(0x1e0)]||(_0x52a22d[_0x2eee98(0x1e0)]={'connected_devices':[]},await _0x52a22d[_0x2eee98(0x1a5)](),console['log']('[â„¹ï¸]\x20Initialized\x20empty\x20data\x20object\x20for\x20agentId='+_0x47fb15)):(_0x52a22d=new m({'agentId':_0x47fb15,'data':{'connected_devices':[]}}),await _0x52a22d[_0x2eee98(0x1a5)](),console['log'](_0x2eee98(0x17d)+_0x47fb15));let _0x401bd7=[];for(let _0x2f2105 of _0x3f41a9){let _0x44de5c=_0x2f2105[_0x2eee98(0x152)]||_0x2f2105['pnpid']||_0x2eee98(0x181),_0x62ff10=_0x52a22d[_0x2eee98(0x1e0)][_0x2eee98(0x1bf)][_0x2eee98(0x159)](_0x5f47b7=>_0x5f47b7[_0x2eee98(0x152)]===_0x44de5c);if(_0x62ff10)_0x401bd7['push']({..._0x2f2105,'status':_0x62ff10['status']}),console[_0x2eee98(0x139)]('[â„¹ï¸]\x20USB\x20exists:\x20'+_0x44de5c+_0x2eee98(0x1cc)+_0x62ff10[_0x2eee98(0x1df)]);else{let _0x137be8={'drive_letter':_0x2f2105['drive_letter']||'','vendor_id':_0x2f2105[_0x2eee98(0x1bb)]||'','product_id':_0x2f2105[_0x2eee98(0x1d8)]||'','description':_0x2f2105[_0x2eee98(0x1d0)]||'','serial_number':_0x44de5c,'status':_0x2eee98(0x1f4),'last_seen':new Date()};_0x52a22d[_0x2eee98(0x1e0)][_0x2eee98(0x1bf)][_0x2eee98(0x13a)](_0x137be8),_0x401bd7[_0x2eee98(0x13a)]({..._0x2f2105,'status':_0x2eee98(0x1f4)}),console[_0x2eee98(0x139)]('[ðŸ†•]\x20New\x20USB\x20added:\x20'+_0x44de5c+_0x2eee98(0x155));}}return await _0x52a22d['save'](),console[_0x2eee98(0x139)](_0x2eee98(0x1f9),_0x47fb15),_0x53863c&&_0x53863c[_0x2eee98(0x1d1)]&&(_0x53863c['emit'](_0x2eee98(0x1d2),{'devices':_0x401bd7}),console[_0x2eee98(0x139)](_0x2eee98(0x1a8),_0x401bd7)),_0x401bd7;}import a18_0x5bd876 from'express';var k=a18_0x5bd876[a18_0x2e9e06(0x179)]();k['get']('/',async(_0x3592a1,_0x187c21)=>{const _0x55ef64=a18_0x2e9e06;try{let _0x250c4a=await m[_0x55ef64(0x159)]();_0x187c21[_0x55ef64(0x1dc)](_0x250c4a);}catch(_0x165902){console[_0x55ef64(0x175)](_0x165902),_0x187c21['status'](0x1f4)[_0x55ef64(0x1dc)]({'message':_0x55ef64(0x144)});}}),k[a18_0x2e9e06(0x169)](a18_0x2e9e06(0x1fa),async(_0x376362,_0x2b95c1)=>{const _0x4ea9be=a18_0x2e9e06;let {serial:_0xd1b724,username:_0x235821,status:_0x593c9c}=_0x376362[_0x4ea9be(0x1a6)];if(!_0xd1b724||!_0x235821||!_0x593c9c)return _0x2b95c1[_0x4ea9be(0x1df)](0x190)[_0x4ea9be(0x1dc)]({'message':_0x4ea9be(0x1a1)});try{let _0x44535f=await m[_0x4ea9be(0x150)]({'agentId':_0x235821});if(!_0x44535f)return _0x2b95c1['status'](0x194)[_0x4ea9be(0x1dc)]({'message':'User\x20not\x20found'});let _0x4ce3e1=_0x44535f[_0x4ea9be(0x1e0)]['connected_devices'][_0x4ea9be(0x159)](_0x5ce195=>_0x5ce195[_0x4ea9be(0x152)]===_0xd1b724);if(!_0x4ce3e1)return _0x2b95c1[_0x4ea9be(0x1df)](0x194)[_0x4ea9be(0x1dc)]({'message':'Device\x20not\x20found'});_0x4ce3e1['status']=_0x593c9c,await _0x44535f[_0x4ea9be(0x1a5)](),_0x2b95c1[_0x4ea9be(0x1dc)]({'message':_0x4ea9be(0x1ca)});}catch(_0x570587){console[_0x4ea9be(0x175)](_0x570587),_0x2b95c1[_0x4ea9be(0x1df)](0x1f4)[_0x4ea9be(0x1dc)]({'message':_0x4ea9be(0x1b8)});}});var G=k;$();import a18_0x1e6e72 from'express';var C=a18_0x1e6e72[a18_0x2e9e06(0x179)]();C['get']('/',async(_0x3511c9,_0x540d60)=>{const _0x3b12a4=a18_0x2e9e06;try{let _0x3f39b0=await l[_0x3b12a4(0x159)]();_0x540d60[_0x3b12a4(0x1dc)](_0x3f39b0);}catch(_0xd7e99d){console[_0x3b12a4(0x175)]('Error\x20fetching\x20visualizer\x20data:',_0xd7e99d),_0x540d60['status'](0x1f4)[_0x3b12a4(0x1dc)]({'error':'Internal\x20Server\x20Error'});}});var H=C;f();import a18_0x52c889 from'express';var N=a18_0x52c889[a18_0x2e9e06(0x179)]();N[a18_0x2e9e06(0x169)](a18_0x2e9e06(0x149),async(_0x458297,_0x4afbb2)=>{const _0x21c0b8=a18_0x2e9e06;try{let _0x35eeac=_0x458297[_0x21c0b8(0x1a6)][_0x21c0b8(0x14b)];if(!_0x35eeac)return _0x4afbb2[_0x21c0b8(0x1df)](0x190)[_0x21c0b8(0x1dc)]({'message':_0x21c0b8(0x1ea)});let _0x38fbc1=await d[_0x21c0b8(0x150)]({'machine_id':_0x35eeac[_0x21c0b8(0x1b1)]});if(_0x38fbc1)return _0x4afbb2['status'](0xc8)[_0x21c0b8(0x1dc)]({'message':'System\x20already\x20exists','id':_0x38fbc1[_0x21c0b8(0x1dd)]});let _0x3d3186=new d(_0x35eeac);await _0x3d3186[_0x21c0b8(0x1a5)](),_0x4afbb2[_0x21c0b8(0x1df)](0xc9)[_0x21c0b8(0x1dc)]({'message':_0x21c0b8(0x1eb),'id':_0x3d3186[_0x21c0b8(0x1dd)]});}catch(_0x9ed9e9){console[_0x21c0b8(0x175)](_0x9ed9e9),_0x4afbb2['status'](0x1f4)[_0x21c0b8(0x1dc)]({'message':_0x21c0b8(0x1b3),'error':_0x9ed9e9[_0x21c0b8(0x1e8)]});}}),N[a18_0x2e9e06(0x1ad)](a18_0x2e9e06(0x149),async(_0x5b9782,_0x4e7157)=>{const _0x5e1423=a18_0x2e9e06;try{let _0x5ed10a=await d['find']();_0x4e7157[_0x5e1423(0x1df)](0xc8)[_0x5e1423(0x1dc)](_0x5ed10a);}catch(_0x1a9668){console[_0x5e1423(0x175)](_0x1a9668),_0x4e7157[_0x5e1423(0x1df)](0x1f4)[_0x5e1423(0x1dc)]({'message':_0x5e1423(0x16d),'error':_0x1a9668[_0x5e1423(0x1e8)]});}});var K=N;j();import{spawn as a18_0x220f4f}from'child_process';import a18_0x2a2632 from'path';import{fileURLToPath as a18_0x203229}from'url';import a18_0x135969 from'mongoose';import a18_0x55117c from'fs';var Ee=a18_0x203229(import.meta[a18_0x2e9e06(0x180)]),O=a18_0x2a2632[a18_0x2e9e06(0x1e2)](Ee),Le=a18_0x2a2632[a18_0x2e9e06(0x199)](O,'scanner_service.py'),We=a18_0x2a2632['join'](O,a18_0x2e9e06(0x19f));function ne(){const _0x38957a=a18_0x2e9e06;try{return JSON['parse'](a18_0x55117c[_0x38957a(0x1e7)](We,_0x38957a(0x164)))[_0x38957a(0x153)]||'';}catch{return'';}}async function Je(){const _0x52f0db=a18_0x2e9e06;let _0x206ecb=ne();for(;!_0x206ecb[_0x52f0db(0x1e5)](_0x52f0db(0x1a2))&&!_0x206ecb['startsWith'](_0x52f0db(0x145));)console[_0x52f0db(0x139)]('âš ï¸\x20Waiting\x20for\x20valid\x20MongoDB\x20Setup...'),await new Promise(_0x5f5455=>setTimeout(_0x5f5455,0xbb8)),_0x206ecb=ne();return console[_0x52f0db(0x139)](_0x52f0db(0x1a0),_0x206ecb),_0x206ecb;}async function Ge(){const _0x1f6ea6=a18_0x2e9e06;let _0x1afb20=await Je();await a18_0x135969['connect'](_0x1afb20)[_0x1f6ea6(0x13e)](()=>console['log'](_0x1f6ea6(0x1db)))[_0x1f6ea6(0x1cd)](_0x2eba4e=>{const _0x5c25db=_0x1f6ea6;console[_0x5c25db(0x175)](_0x5c25db(0x1ee),_0x2eba4e['message']),process[_0x5c25db(0x1a7)](0x1);});}async function Ce(){const _0x31d5ef=a18_0x2e9e06;return console[_0x31d5ef(0x139)](_0x31d5ef(0x1c7)),new Promise(_0x457fbe=>{const _0x50b71c=_0x31d5ef;let _0x449c89=a18_0x220f4f(_0x50b71c(0x18e),[Le],{'cwd':O,'stdio':[_0x50b71c(0x198),_0x50b71c(0x1de),_0x50b71c(0x1de)]}),_0x8f433c='';_0x449c89[_0x50b71c(0x19d)][_0x50b71c(0x1cb)](_0x50b71c(0x164)),_0x449c89[_0x50b71c(0x19d)]['on']('data',async _0x1c06e9=>{const _0x443b1a=_0x50b71c;if(_0x8f433c+=_0x1c06e9['toString'](),_0x8f433c['trim']()[_0x443b1a(0x15a)](']'))try{let _0x1b12b2=_0x8f433c[_0x443b1a(0x182)]('['),_0x117940=_0x8f433c[_0x443b1a(0x135)](_0x1b12b2)[_0x443b1a(0x1f7)](),_0x41f6f2=JSON[_0x443b1a(0x1c9)](_0x117940);console[_0x443b1a(0x139)](_0x443b1a(0x1c1)+_0x41f6f2[_0x443b1a(0x156)]+'\x20devices\x20from\x20Python');let _0x277028=_0x41f6f2[_0x443b1a(0x157)](_0x2e16ab=>_0x2e16ab[_0x443b1a(0x161)][0x0]);await S['deleteMany']({'ips.0':{'$nin':_0x277028}});for(let _0x1bc5ea of _0x41f6f2)await S['findOneAndUpdate']({'ips.0':_0x1bc5ea[_0x443b1a(0x161)][0x0]},{..._0x1bc5ea,'lastSeen':new Date()},{'upsert':!0x0,'new':!0x0});console[_0x443b1a(0x139)]('âœ…\x20Synced\x20'+_0x41f6f2[_0x443b1a(0x156)]+_0x443b1a(0x163)),console[_0x443b1a(0x139)]('âš™ï¸\x20Running\x20visualizer\x20update\x20after\x20scan...');try{let {runVisualizerUpdate:_0x1663c1}=await Promise[_0x443b1a(0x1ab)]()[_0x443b1a(0x13e)](()=>(te(),ee));await _0x1663c1(),console[_0x443b1a(0x139)](_0x443b1a(0x1e1));}catch(_0x2a93b6){console[_0x443b1a(0x175)](_0x443b1a(0x172),_0x2a93b6[_0x443b1a(0x1e8)]);}_0x8f433c='';}catch(_0x1af13d){console[_0x443b1a(0x175)]('âŒ\x20JSON\x20parse\x20error:',_0x1af13d[_0x443b1a(0x1e8)]),_0x8f433c='';}}),_0x449c89[_0x50b71c(0x176)]['on'](_0x50b71c(0x1e0),_0x56c73f=>{const _0x13fb77=_0x50b71c;console[_0x13fb77(0x175)](_0x13fb77(0x1be),_0x56c73f[_0x13fb77(0x1cf)]());}),_0x449c89['on'](_0x50b71c(0x146),_0x212ee6=>{const _0xc7b61d=_0x50b71c;console['log'](_0xc7b61d(0x18d)+_0x212ee6),_0x457fbe();});});}async function He(){const _0x4aad6e=a18_0x2e9e06;for(await Ge();;)console[_0x4aad6e(0x139)](_0x4aad6e(0x14a)+new Date()[_0x4aad6e(0x14d)]()),await Ce(),console[_0x4aad6e(0x139)](_0x4aad6e(0x1e9)),await new Promise(_0x23814a=>setTimeout(_0x23814a,0x1388));}He();var Ye=a18_0x3c3590[a18_0x2e9e06(0x1ab)]('./config.json'),h=JSON['parse'](a18_0x2314e2[a18_0x2e9e06(0x1e7)](Ye,'utf8')),u=a18_0x558ca6();u[a18_0x2e9e06(0x1a9)](a18_0xe4411a({'origin':h[a18_0x2e9e06(0x162)]||'*'})),u[a18_0x2e9e06(0x1a9)](a18_0x558ca6[a18_0x2e9e06(0x1dc)]()),u[a18_0x2e9e06(0x1a9)](a18_0x2e9e06(0x17c),H),u[a18_0x2e9e06(0x1a9)](a18_0x2e9e06(0x18a),K),u[a18_0x2e9e06(0x1ad)]('/health',(_0x48697c,_0x1a0c77)=>_0x1a0c77[a18_0x2e9e06(0x1dc)]({'status':'ok','ts':new Date()['toISOString']()})),u[a18_0x2e9e06(0x1a9)]('/api/usb',G);var se=a18_0x3a71a3[a18_0x2e9e06(0x1b4)](u),Ze=new a18_0x3b0423(se,{'cors':{'origin':h['cors_origin']||'*','methods':[a18_0x2e9e06(0x1f2),'POST']},'pingTimeout':0x4e20,'pingInterval':0x1388}),B=a18_0x3c3590[a18_0x2e9e06(0x199)](process[a18_0x2e9e06(0x1ef)](),'agent_data_log.json');Ze['on']('connection',_0x57e3a7=>{const _0x45516f=a18_0x2e9e06;let _0x2c1824=_0x57e3a7[_0x45516f(0x1c5)]['headers']['x-forwarded-for']?.[_0x45516f(0x177)](',')[0x0]||_0x57e3a7['handshake'][_0x45516f(0x18c)]||_0x45516f(0x181);console['log']('ðŸ”Œ\x20Agent\x20connected:\x20'+_0x57e3a7['id']+'\x20('+_0x2c1824+')'),_0x57e3a7['on'](_0x45516f(0x14c),async _0x189b4d=>{const _0x249843=_0x45516f;try{if(!_0x189b4d?.['type']||!_0x189b4d?.[_0x249843(0x1e0)]||!_0x189b4d?.[_0x249843(0x151)]){_0x57e3a7['emit']('agent_response',{'success':!0x1,'message':_0x249843(0x13b)});return;}_0x189b4d['ip']=_0x2c1824;try{let _0x3e9d6a=a18_0x2314e2['existsSync'](B)?JSON['parse'](a18_0x2314e2[_0x249843(0x1e7)](B,'utf-8')):[];_0x3e9d6a[_0x249843(0x13a)]({'timestamp':new Date()['toISOString'](),'payload':_0x189b4d}),a18_0x2314e2[_0x249843(0x1d5)](B,JSON[_0x249843(0x15d)](_0x3e9d6a,null,0x2),_0x249843(0x1e6));}catch(_0x344bb6){console[_0x249843(0x175)](_0x249843(0x1b2),_0x344bb6);}if(console[_0x249843(0x139)](_0x249843(0x1f0)+_0x189b4d[_0x249843(0x196)]+_0x249843(0x19a)+_0x189b4d['agentId']+'\x20('+_0x2c1824+')'),_0x189b4d[_0x249843(0x196)]===_0x249843(0x131)){let _0x30c42d=_0x189b4d[_0x249843(0x1e0)][_0x249843(0x1bf)]||[];console[_0x249843(0x139)](_0x249843(0x147),_0x30c42d);let _0x3b831a=await J(_0x189b4d[_0x249843(0x151)],_0x30c42d);_0x57e3a7['emit'](_0x249843(0x1d2),{'devices':_0x3b831a}),console['log'](_0x249843(0x133),_0x3b831a);return;}await T(_0x189b4d),_0x57e3a7[_0x249843(0x158)](_0x249843(0x1f5),{'success':!0x0,'message':_0x189b4d[_0x249843(0x196)]+_0x249843(0x16e)});}catch(_0x48ae3e){console[_0x249843(0x175)](_0x249843(0x174),_0x48ae3e),_0x57e3a7['emit'](_0x249843(0x1f5),{'success':!0x1,'message':'Failed\x20to\x20save\x20agent\x20data','error':_0x48ae3e['message']});}}),_0x57e3a7['on'](_0x45516f(0x183),async(_0x32f39b,_0x579b5f)=>{const _0x128921=_0x45516f;try{let _0xc9848a=await W(_0x32f39b);_0x579b5f(_0xc9848a);}catch(_0x44dad8){console['error']('âŒ\x20Error\x20fetching\x20data:',_0x44dad8),_0x579b5f({'success':!0x1,'message':_0x128921(0x15b),'error':_0x44dad8[_0x128921(0x1e8)],'data':[]});}}),_0x57e3a7['on']('disconnect',_0x561780=>{console['log']('âš ï¸\x20Agent\x20disconnected:\x20'+_0x57e3a7['id']+'\x20('+_0x561780+')');});});async function et(){const _0x261733=a18_0x2e9e06;try{await P(h[_0x261733(0x153)]),console['log'](_0x261733(0x1aa)),se[_0x261733(0x189)](h[_0x261733(0x1c3)]||0x1388,_0x261733(0x142),()=>{const _0x2d9d34=_0x261733;console[_0x2d9d34(0x139)](_0x2d9d34(0x1bc)+(h['socket_port']||0x1388));});}catch(_0x2064ca){console['error'](_0x261733(0x1ed),_0x2064ca),process['exit'](0x1);}}et();