function a15_0x560f(){const _0x1fbde1=['1412lPafFO','.2.1','.1.254','321wbiGWk','lean','os_type','message','agentId','47160gWQcYM','.225.1','Unknown','.42.129','os_version','noAgent','memory','error','1378706buyrnu','status','hostname','online','logical_cores','ram_percent','.0.1','now','drive_letter','timestamp','.0.254','endsWith','2652pbfjHt','.137.1','6vkMYYR','.1.1','find','getTime','.248.1','filter','Allowed','473devvmr','cpu','data','134yrtjlM','.10.1','map','description','.43.1','Server\x20running\x20OK','last_seen','793335yMLHTp','1672317RWvckj','218200KaNiKj'];a15_0x560f=function(){return _0x1fbde1;};return a15_0x560f();}(function(_0x21ff0a,_0x3f6ca3){const _0x1b84d4=a15_0x1efe,_0x59e18c=_0x21ff0a();while(!![]){try{const _0x4b39e6=-parseInt(_0x1b84d4(0x200))/0x1*(-parseInt(_0x1b84d4(0x1f4))/0x2)+-parseInt(_0x1b84d4(0x1db))/0x3*(-parseInt(_0x1b84d4(0x1d8))/0x4)+-parseInt(_0x1b84d4(0x1d5))/0x5+parseInt(_0x1b84d4(0x1f6))/0x6*(parseInt(_0x1b84d4(0x1e8))/0x7)+-parseInt(_0x1b84d4(0x1d7))/0x8+parseInt(_0x1b84d4(0x1d6))/0x9+-parseInt(_0x1b84d4(0x1e0))/0xa*(parseInt(_0x1b84d4(0x1fd))/0xb);if(_0x4b39e6===_0x3f6ca3)break;else _0x59e18c['push'](_0x59e18c['shift']());}catch(_0x9b928f){_0x59e18c['push'](_0x59e18c['shift']());}}}(a15_0x560f,0x33258));import a15_0x1af322 from'../models/SystemInfo.js';import a15_0x345ddd from'../models/VisualizerData.js';import a15_0x37ce46 from'../models/usbdevices.js';function a15_0x1efe(_0x5a387e,_0xbc2b9c){const _0x560f22=a15_0x560f();return a15_0x1efe=function(_0x1efea0,_0x695b9d){_0x1efea0=_0x1efea0-0x1d2;let _0x6f28f6=_0x560f22[_0x1efea0];return _0x6f28f6;},a15_0x1efe(_0x5a387e,_0xbc2b9c);}function isRouter(_0x50e916=''){const _0x487075=a15_0x1efe;return _0x50e916['endsWith'](_0x487075(0x1ee))||_0x50e916[_0x487075(0x1f3)](_0x487075(0x1f7))||_0x50e916['endsWith']('.254')||_0x50e916[_0x487075(0x1f3)](_0x487075(0x1da))||_0x50e916['endsWith'](_0x487075(0x1f2))||_0x50e916[_0x487075(0x1f3)](_0x487075(0x1d2))||_0x50e916[_0x487075(0x1f3)](_0x487075(0x1f5))||_0x50e916[_0x487075(0x1f3)](_0x487075(0x1d9))||_0x50e916[_0x487075(0x1f3)](_0x487075(0x201))||_0x50e916[_0x487075(0x1f3)](_0x487075(0x1fa))||_0x50e916[_0x487075(0x1f3)](_0x487075(0x1e1))||_0x50e916[_0x487075(0x1f3)](_0x487075(0x1e3));}export async function getLogsSnapshot(){const _0x4f2eb1=a15_0x1efe;try{const _0x3ebaf3=Date[_0x4f2eb1(0x1ef)](),_0x39da87=await a15_0x1af322[_0x4f2eb1(0x1f8)]({},{'agentId':0x1,'data.hostname':0x1,'data.ip':0x1,'data.os_type':0x1,'data.os_version':0x1,'data.memory.ram_percent':0x1,'data.cpu.logical_cores':0x1,'timestamp':0x1})[_0x4f2eb1(0x1dc)](),_0x420513=_0x39da87[_0x4f2eb1(0x202)](_0x3ed503=>{const _0x19f2a4=_0x4f2eb1,_0x51eb72=new Date(_0x3ed503[_0x19f2a4(0x1f1)])[_0x19f2a4(0x1f9)](),_0x20c0dd=_0x3ebaf3-_0x51eb72<0x3a98;return{'agentId':_0x3ed503[_0x19f2a4(0x1df)],'hostname':_0x3ed503['data']?.[_0x19f2a4(0x1ea)]||_0x19f2a4(0x1e2),'ip':_0x3ed503[_0x19f2a4(0x1ff)]?.['ip']||_0x19f2a4(0x1e2),'os_type':_0x3ed503[_0x19f2a4(0x1ff)]?.[_0x19f2a4(0x1dd)]||_0x19f2a4(0x1e2),'os_version':_0x3ed503[_0x19f2a4(0x1ff)]?.[_0x19f2a4(0x1e4)]||_0x19f2a4(0x1e2),'ram_percent':_0x3ed503['data']?.[_0x19f2a4(0x1e6)]?.[_0x19f2a4(0x1ed)]||0x0,'cpu_cores':_0x3ed503[_0x19f2a4(0x1ff)]?.[_0x19f2a4(0x1fe)]?.[_0x19f2a4(0x1ec)]||0x0,'status':_0x20c0dd?_0x19f2a4(0x1eb):'offline','lastSeen':_0x3ed503[_0x19f2a4(0x1f1)]};}),_0x538452=await a15_0x345ddd['find']({})[_0x4f2eb1(0x1dc)](),_0x58abad=_0x538452[_0x4f2eb1(0x1fb)](_0x222ace=>_0x222ace[_0x4f2eb1(0x1e5)]&&!isRouter(_0x222ace['ip'])),_0x1e17a4=await a15_0x37ce46[_0x4f2eb1(0x1f8)]({})[_0x4f2eb1(0x1dc)](),_0x439287=_0x1e17a4[_0x4f2eb1(0x202)](_0xcb6b08=>({'agentId':_0xcb6b08[_0x4f2eb1(0x1df)],'devices':(_0xcb6b08[_0x4f2eb1(0x1ff)]?.['connected_devices']||[])[_0x4f2eb1(0x202)](_0x18e854=>({'serial_number':_0x18e854['serial_number'],'description':_0x18e854[_0x4f2eb1(0x203)],'drive_letter':_0x18e854[_0x4f2eb1(0x1f0)],'status':_0x18e854[_0x4f2eb1(0x1e9)],'last_seen':_0x18e854[_0x4f2eb1(0x1e9)]===_0x4f2eb1(0x1fc)||_0x18e854['status']==='WaitingForApproval'?new Date():_0x18e854[_0x4f2eb1(0x1d4)]}))})),_0x2ed5bb={'status':_0x4f2eb1(0x1eb),'message':_0x4f2eb1(0x1d3)},_0x1c0cdb={'agents':_0x420513,'server':_0x2ed5bb,'unknownDevices':_0x58abad,'usbDevices':_0x439287,'timestamp':new Date()};return _0x1c0cdb;}catch(_0x26d03d){return console[_0x4f2eb1(0x1e7)]('‚ùå\x20Error\x20building\x20logs\x20snapshot:',_0x26d03d),{'agents':[],'server':{'status':'error','message':_0x26d03d[_0x4f2eb1(0x1de)]},'unknownDevices':[],'usbDevices':[],'timestamp':new Date()};}}